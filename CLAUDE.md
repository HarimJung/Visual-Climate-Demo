# CLAUDE.md - Agent Workflow Guidelines

## 1. Workflow Orchestration

### Plan Mode Default
- 3단계 이상의 복잡한 작업이나 아키텍처 결정이 필요한 비정형 작업 전에는 반드시 계획 모드(Plan Mode)로 진입한다.
- 작업이 예상과 다르게 흘러가면 즉시 중단하고 계획을 재수립한다. 무리하게 진행하지 않는다.
- 검증 단계에서도 계획 모드를 활용한다.
- 모호함을 줄이기 위해 사전에 상세 스펙을 작성한다.

### Subagent Strategy
- 메인 컨텍스트 윈도우를 깨끗하게 유지하기 위해 서브에이전트를 적극 활용한다.
- 리서치, 탐색, 병렬 분석 작업은 서브에이전트에게 위임한다.
- 복잡한 문제의 경우 서브에이전트를 통해 더 많은 연산 자원을 투입한다.
- 한 서브에이전트당 하나의 작업만 할당한다.

### Self-Improvement Loop
- 사용자의 모든 수정 사항 이후 반드시 `tasks/lessons.md`에 해당 패턴을 업데이트한다.
- 같은 실수를 방지하기 위한 규칙을 작성한다.
- 실수율이 떨어질 때까지 레슨들을 반복 적용한다.
- 관련 프로젝트 세션 시작 시 레슨들을 검토한다.

### Verification Before Done
- 작업이 실제로 작동함을 증명하기 전에는 절대 완료로 표시하지 않는다.
- 메인 코드와 변경 사항 사이의 동작 차이를 분석한다.
- 스스로 묻는다: "수석 엔지니어(Staff Engineer)가 이것을 승인할 것인가?"
- 테스트를 실행하고, 로그를 확인하며, 코드의 정확성을 입증한다.

### Demand Elegance (Balanced)
- 사소하지 않은 변경에 대해 "더 우아한 방법이 있는가?"를 자문한다.
- 임시방편이라 느껴지면, 가장 우아한 해결책을 구현한다.
- 단순 명확한 수정은 건너뛰되, 과도한 엔지니어링은 피한다.
- 제출 전에 스스로의 작업 결과에 도전(Challenge)해 본다.

### Autonomous Bug Fixing
- 버그 리포트를 받으면 즉시 수정한다. 사용자에게 일일이 도움을 요청하지 않는다.
- 로그, 에러 메시지, 실패한 테스트를 분석하여 스스로 해결책을 찾는다.
- 사용자에게 컨텍스트 전환을 요구하지 않는다.
- 지시받지 않아도 실패하는 CI 테스트를 스스로 수정한다.

## 2. Task Management

- **Plan First**: `tasks/todo.md`에 체크 가능한 항목으로 계획을 작성한다.
- **Verify Plan**: 구현 시작 전에 계획을 확인한다.
- **Track Progress**: 각 단계를 진행하면서 완료된 항목을 표시한다.
- **Explain Changes**: 각 단계에서 고수준의 요약을 제공한다.
- **Document Results**: `tasks/todo.md`에 리뷰 섹션을 추가하여 결과를 문서화한다.
- **Capture Lessons**: 수정이 발생하면 `tasks/lessons.md`를 업데이트한다.

## 3. Core Principles

- **Simplicity First**: 모든 변경 사항은 최대한 단순하게 유지한다. 코드 영향도를 최소화한다.
- **No Laziness**: 근본 원인(Root causes)을 찾아 해결한다. 임시방편은 거부한다. 시니어 개발자 표준을 준수한다.
- **Minimal Impact**: 꼭 필요한 부분만 수정한다. 불필요한 버그 도입을 방지한다.
